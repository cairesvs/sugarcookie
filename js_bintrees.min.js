function rb_assert(a,b){if(a===null)return 1;else{var c=a.left;var d=a.right;if(is_red(a)){if(!is_red(c)&&!is_red(d)){throw"red violation"}}var e=rb_assert(c,b);var f=rb_assert(d,b);if(c!==null&&b(c.data,a.data)>=0||(d!==null&&b(d.data,a.data)<=0)==false){throw"binary tree violation"}if(e==0||f==0||e==f){throw"black violation"}if(e!=0&&f!=0)return is_red(a)?e:e+1;else return 0}}function double_rotate(a,b){a.set_child(!b,single_rotate(a.get_child(!b),!b));return single_rotate(a,b)}function single_rotate(a,b){var c=a.get_child(!b);a.set_child(!b,c.get_child(b));c.set_child(b,a);a.red=true;c.red=false;return c}function is_red(a){return a!==null&&a.red}function RBTree(a){this._root=null;this._comparator=a;this.size=0}function Node(a){this.data=a;this.left=null;this.right=null;this.red=true}function Iterator(a){this._tree=a;this._ancestors=[];this._cursor=null}function TreeBase(){}TreeBase.prototype.clear=function(){this._root=null;this.size=0};TreeBase.prototype.find=function(a){var b=this._root;while(b!==null){var c=this._comparator(a,b.data);if(c==0)return b.data;else b=b.get_child(c>0)}return null};TreeBase.prototype.min=function(){var a=this._root;if(a===null)return null;while(a.left!==null)a=a.left;return a.data};TreeBase.prototype.max=function(){var a=this._root;if(a===null)return null;while(a.right!==null)a=a.right;return a.data};TreeBase.prototype.iterator=function(){return new Iterator(this)};TreeBase.prototype.each=function(a){var b=this.iterator(),c;while((c=b.next())!==null){a(c)}};TreeBase.prototype.reach=function(a){var b=this.iterator(),c;while((c=b.prev())!==null){a(c)}};Iterator.prototype.data=function(){return this._cursor!==null?this._cursor.data:null};Iterator.prototype.next=function(){if(this._cursor===null){var a=this._tree._root;if(a!==null)this._minNode(a)}else{if(this._cursor.right===null){do{var b=this._cursor;if(this._ancestors.length)this._cursor=this._ancestors.pop();else{this._cursor=null;break}}while(this._cursor.right===b)}else{this._ancestors.push(this._cursor);this._minNode(this._cursor.right)}}return this._cursor!==null?this._cursor.data:null};Iterator.prototype.prev=function(){if(this._cursor===null){var a=this._tree._root;if(a!==null)this._maxNode(a)}else{if(this._cursor.left===null){do{var b=this._cursor;if(this._ancestors.length)this._cursor=this._ancestors.pop();else{this._cursor=null;break}}while(this._cursor.left===b)}else{this._ancestors.push(this._cursor);this._maxNode(this._cursor.left)}}return this._cursor!==null?this._cursor.data:null};Iterator.prototype._minNode=function(a){while(a.left!==null){this._ancestors.push(a);a=a.left}this._cursor=a};Iterator.prototype._maxNode=function(a){while(a.right!==null){this._ancestors.push(a);a=a.right}this._cursor=a};Node.prototype.get_child=function(a){return a?this.right:this.left};Node.prototype.set_child=function(a,b){if(a)this.right=b;else this.left=b};RBTree.prototype=new TreeBase;RBTree.prototype.assert=function(){return rb_assert(this._root,this._comparator)!=0};RBTree.prototype.insert=function(a){var b=false;if(this._root===null){this._root=new Node(a);b=true;this.size++}else{var c=new Node(undefined);var d=0;var e=0;var f=null;var g=c;var h=null;var i=this._root;g.right=this._root;while(true){if(i===null){i=new Node(a);h.set_child(d,i);b=true;this.size++}else if(is_red(i.left)&&is_red(i.right)){i.red=true;i.left.red=false;i.right.red=false}if(is_red(i)&&is_red(h)){var j=g.right===f;if(i===h.get_child(e))g.set_child(j,single_rotate(f,!e));else g.set_child(j,double_rotate(f,!e))}var k=this._comparator(i.data,a);if(k==0)break;e=d;d=k<0;if(f!==null)g=f;f=h;h=i;i=i.get_child(d)}this._root=c.right}this._root.red=false;return b};RBTree.prototype.remove=function(a){if(this._root===null)return false;var b=new Node(undefined);var c=b;c.right=this._root;var d=null;var e=null;var f=null;var g=1;while(c.get_child(g)!==null){var h=g;e=d;d=c;c=c.get_child(g);var i=this._comparator(a,c.data);g=i>0;if(i==0)f=c;if(!is_red(c)&&!is_red(c.get_child(g))){if(is_red(c.get_child(!g))){var j=single_rotate(c,g);d.set_child(h,j);d=j}else if(!is_red(c.get_child(!g))){var k=d.get_child(!h);if(k!==null){if(!is_red(k.get_child(!h))&&!is_red(k.get_child(h))){d.red=false;k.red=true;c.red=true}else{var l=e.right===d;if(is_red(k.get_child(h)))e.set_child(l,double_rotate(d,h));else if(is_red(k.get_child(!h)))e.set_child(l,single_rotate(d,h));var m=e.get_child(l);m.red=true;c.red=true;m.left.red=false;m.right.red=false}}}}}if(f!==null){f.data=c.data;d.set_child(d.right===c,c.get_child(c.left===null));this.size--}this._root=b.right;if(this._root!==null)this._root.red=false;return f!==null}